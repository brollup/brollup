use serde::{Deserialize, Serialize};

/// The bitsize of the `CommonLongVal`.
pub const COMMON_LONG_BITSIZE: u8 = 7;

/// `CommonLongVal` represents a common u64 integer value.
#[derive(Debug, Clone, PartialEq, Eq, Serialize, Deserialize)]
pub struct CommonLongVal {
    pub value: u64,
    pub index: u8,
}

impl CommonLongVal {
    /// Creates a new `CommonLongVal` from a `u64` integer.
    pub fn new(value: u64) -> Option<CommonLongVal> {
        // Get the index.
        let index = match value {
            50 => 0,
            100 => 1,
            200 => 2,
            250 => 3,
            500 => 4,
            550 => 5,
            600 => 6,
            750 => 7,
            800 => 8,
            900 => 9,
            999 => 10,
            1_000 => 11,
            1_500 => 12,
            2_000 => 13,
            2_500 => 14,
            3_000 => 15,
            4_000 => 16,
            5_000 => 17,
            5_500 => 18,
            6_000 => 19,
            7_000 => 20,
            7_500 => 21,
            8_000 => 22,
            9_000 => 23,
            9_900 => 24,
            10_000 => 25,
            15_000 => 26,
            20_000 => 27,
            25_000 => 28,
            30_000 => 29,
            35_000 => 30,
            40_000 => 31,
            50_000 => 32,
            55_000 => 33,
            60_000 => 34,
            70_000 => 35,
            75_000 => 36,
            80_000 => 37,
            90_000 => 38,
            99_900 => 39,
            100_000 => 40,
            150_000 => 41,
            200_000 => 42,
            250_000 => 43,
            300_000 => 44,
            350_000 => 45,
            400_000 => 46,
            500_000 => 47,
            550_000 => 48,
            600_000 => 49,
            700_000 => 50,
            750_000 => 51,
            800_000 => 52,
            900_000 => 53,
            1_000_000 => 54,
            2_000_000 => 55,
            2_500_000 => 56,
            5_000_000 => 57,
            5_500_000 => 58,
            10_000_000 => 59,
            25_000_000 => 60,
            50_000_000 => 61,
            75_000_000 => 62,
            100_000_000 => 63,
            150_000_000 => 64,
            200_000_000 => 65,
            250_000_000 => 66,
            300_000_000 => 67,
            350_000_000 => 68,
            400_000_000 => 69,
            500_000_000 => 70,
            550_000_000 => 71,
            600_000_000 => 72,
            700_000_000 => 73,
            750_000_000 => 74,
            800_000_000 => 75,
            900_000_000 => 76,
            1_000_000_000 => 77,
            2_000_000_000 => 78,
            2_500_000_000 => 79,
            5_000_000_000 => 80,
            5_500_000_000 => 81,
            10_000_000_000 => 82,
            25_000_000_000 => 83,
            50_000_000_000 => 84,
            75_000_000_000 => 85,
            100_000_000_000 => 86,
            150_000_000_000 => 87,
            200_000_000_000 => 88,
            250_000_000_000 => 89,
            300_000_000_000 => 90,
            350_000_000_000 => 91,
            400_000_000_000 => 92,
            500_000_000_000 => 93,
            550_000_000_000 => 94,
            600_000_000_000 => 95,
            700_000_000_000 => 96,
            750_000_000_000 => 97,
            800_000_000_000 => 98,
            900_000_000_000 => 99,
            1_000_000_000_000 => 100,
            2_000_000_000_000 => 101,
            2_500_000_000_000 => 102,
            5_000_000_000_000 => 103,
            5_500_000_000_000 => 104,
            10_000_000_000_000 => 105,
            25_000_000_000_000 => 106,
            50_000_000_000_000 => 107,
            75_000_000_000_000 => 108,
            100_000_000_000_000 => 109,
            150_000_000_000_000 => 110,
            200_000_000_000_000 => 111,
            250_000_000_000_000 => 112,
            300_000_000_000_000 => 113,
            350_000_000_000_000 => 114,
            400_000_000_000_000 => 115,
            500_000_000_000_000 => 116,
            550_000_000_000_000 => 117,
            600_000_000_000_000 => 118,
            700_000_000_000_000 => 119,
            750_000_000_000_000 => 120,
            800_000_000_000_000 => 121,
            900_000_000_000_000 => 122,
            1_000_000_000_000_000 => 123,
            2_000_000_000_000_000 => 124,
            2_500_000_000_000_000 => 125,
            5_000_000_000_000_000 => 126,
            10_000_000_000_000_000 => 127,

            _ => return None, // Invalid value
        };

        // Create a new `CommonVal`.
        let common_long_val = CommonLongVal { value, index };

        // Return the `CommonVal`.
        Some(common_long_val)
    }

    /// Returns the inner u64 value of the `CommonLongVal`.
    pub fn value(&self) -> u64 {
        self.value
    }

    /// Returns the index of the `CommonLongVal`.
    pub fn index(&self) -> u8 {
        self.index
    }
}
